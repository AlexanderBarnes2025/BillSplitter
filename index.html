<script>
const paymentsDiv = document.getElementById('payments');
let personCount = 0;

// Start with 2 people
addPerson();
addPerson();

function addPerson(name='', amount='') {
    personCount++;
    const div = document.createElement('div');
    div.className = 'person clearfix';
    div.dataset.personId = personCount; // keep internal id
    div.innerHTML = `
        <label>Person ${personCount} Name:</label>
        <input type="text" class="name" placeholder="Enter name" value="${name}">
        <label>Person ${personCount} Paid:</label>
        <input type="number" class="paid" min="0" placeholder="Enter amount" value="${amount}" oninput="updateSummary()">
        <button class="remove-btn" onclick="removePerson(this)">Remove</button>
    `;
    paymentsDiv.appendChild(div);
    renumberPersons();
    div.scrollIntoView({ behavior: 'smooth', block: 'center' });
    updateSummary();
}

function removePerson(button) {
    const div = button.parentElement;
    paymentsDiv.removeChild(div);
    renumberPersons();
    updateSummary();
}

function renumberPersons() {
    const personDivs = document.querySelectorAll('.person');
    personDivs.forEach((div, index) => {
        const nameLabel = div.querySelector('label:first-of-type');
        const paidLabel = div.querySelector('label:nth-of-type(2)');
        nameLabel.innerText = `Person ${index+1} Name:`;
        paidLabel.innerText = `Person ${index+1} Paid:`;
    });
}

function updateSummary() {
    const personDivs = document.querySelectorAll('.person');
    let subtotal = 0;
    personDivs.forEach(div => {
        const amount = parseFloat(div.querySelector('.paid').value) || 0;
        subtotal += amount;
    });
    const tax = parseFloat(document.getElementById('tax').value) || 0;
    const tip = parseFloat(document.getElementById('tip').value) || 0;
    const total = subtotal + tax + tip;

    document.getElementById('subtotalDisplay').innerText = subtotal.toFixed(2);
    document.getElementById('taxDisplay').innerText = tax.toFixed(2);
    document.getElementById('tipDisplay').innerText = tip.toFixed(2);
    document.getElementById('totalDisplay').innerText = total.toFixed(2);
}
</script>

